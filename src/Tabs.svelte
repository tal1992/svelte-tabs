<script context="module">export const TABS = {};</script>
<script>import{afterUpdate,setContext,onDestroy,onMount,tick}from"svelte";import{writable}from"svelte/store";export let selectedTabIndex=0;const tabElements=[],tabs=[],panels=[],controls=writable({}),labeledBy=writable({}),selectedTab=writable(null),selectedPanel=writable(null);function removeAndUpdateSelected(e,t,s){const a=e.indexOf(t);e.splice(a,1),s.update(s=>s===t?e[a]||e[e.length-1]:s)}function registerItem(e,t,s){e.push(t),s.update(e=>e||t),onDestroy(()=>removeAndUpdateSelected(e,t,s))}function selectTab(e){selectedTabIndex=tabs.indexOf(e),selectedTab.set(e),selectedPanel.set(panels[selectedTabIndex])}async function handleKeyDown(e){if(e.target.classList.contains("svelte-tabs__tab")){let t=tabs.indexOf($selectedTab);switch(e.key){case"ArrowRight":(t+=1)>tabs.length-1&&(t=0),selectTab(tabs[t]),tabElements[t].focus();break;case"ArrowLeft":(t-=1)<0&&(t=tabs.length-1),selectTab(tabs[t]),tabElements[t].focus()}}}setContext(TABS,{registerTab(e){registerItem(tabs,e,selectedTab)},registerTabElement(e){tabElements.push(e)},registerPanel(e){registerItem(panels,e,selectedPanel)},selectTab:selectTab,selectedTab:selectedTab,selectedPanel:selectedPanel,controls:controls,labeledBy:labeledBy}),onMount(()=>{selectTab(tabs[selectedTabIndex])}),afterUpdate(()=>{for(let e=0;e<tabs.length;e++)controls.update(t=>({...t,[tabs[e].id]:panels[e].id})),labeledBy.update(t=>({...t,[panels[e].id]:tabs[e].id}))});</script>
<div class="svelte-tabs" on:keydown={handleKeyDown}> <slot></slot></div>